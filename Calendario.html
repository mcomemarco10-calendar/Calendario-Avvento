<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Puzzle Quiz</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    padding: 20px;
  }
  h1 { margin-bottom: 10px; }
  #puzzle-container {
    position: relative;
    width: 400px;
    height: 400px;
    border: 2px solid #ccc;
    margin-top: 20px;
    background-size: cover;
    background-position: center;
  }
  .piece {
    position: absolute;
    width: 25%;
    height: 25%;
    background-color: rgba(0, 0, 150, 0.8);
    border: 1px solid white;
    cursor: pointer;
    transition: 0.3s;
  }
  .piece:hover {
    transform: scale(1.05);
  }
  .hidden {
    opacity: 0;
    pointer-events: none;
  }
  .failed {
    background-color: rgba(120, 120, 120, 0.8);
  }
  #controls {
    margin-top: 10px;
    text-align: center;
  }
  #question-box {
    margin-top: 15px;
    padding: 10px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: none;
  }
  input, button {
    margin: 5px;
    padding: 6px 10px;
    font-size: 14px;
  }
</style>
</head>
<body>

<h1>ðŸ§© Gioco Puzzle Quiz</h1>

<input type="file" id="image-input" accept="image/*" />
<div id="puzzle-container"></div>

<div id="question-box">
  <p><b>Domanda:</b> <input id="question" type="text" placeholder="Scrivi la domanda..." size="40"></p>
  <p><b>Risposta corretta:</b> <input id="correct-answer" type="text" placeholder="Scrivi la risposta..." size="30"></p>
  <p><b>Risposta del giocatore:</b> <input id="user-answer" type="text" placeholder="Inserisci la risposta..." size="30"></p>
  <button id="check-btn">Conferma</button>
  <button id="cancel-btn">Annulla</button>
</div>

<script>
  const puzzleContainer = document.getElementById("puzzle-container");
  const imageInput = document.getElementById("image-input");
  const questionBox = document.getElementById("question-box");
  const questionInput = document.getElementById("question");
  const correctInput = document.getElementById("correct-answer");
  const userInput = document.getElementById("user-answer");
  const checkBtn = document.getElementById("check-btn");
  const cancelBtn = document.getElementById("cancel-btn");

  let selectedPiece = null;

  // Creazione della griglia 4x4
  for (let r = 0; r < 4; r++) {
    for (let c = 0; c < 4; c++) {
      const piece = document.createElement("div");
      piece.classList.add("piece");
      piece.style.top = r * 25 + "%";
      piece.style.left = c * 25 + "%";
      piece.addEventListener("click", () => openQuestion(piece));
      puzzleContainer.appendChild(piece);
    }
  }

  // Caricamento immagine
  imageInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (event) => {
      puzzleContainer.style.backgroundImage = `url('${event.target.result}')`;
    };
    reader.readAsDataURL(file);
  });

  function openQuestion(piece) {
    selectedPiece = piece;
    questionBox.style.display = "block";
    userInput.value = "";
  }

  checkBtn.addEventListener("click", () => {
    const correct = correctInput.value.trim().toLowerCase();
    const userAns = userInput.value.trim().toLowerCase();
    if (!selectedPiece) return;
    if (correct && userAns === correct) {
      selectedPiece.classList.add("hidden");
    } else {
      selectedPiece.classList.add("failed");
    }
    questionBox.style.display = "none";
  });

  cancelBtn.addEventListener("click", () => {
    questionBox.style.display = "none";
    selectedPiece = null;
  });
</script>

</body>
</html>
